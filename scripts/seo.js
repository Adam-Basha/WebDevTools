const fs=require('fs');const path=require('path');const xml2js=require('xml2js');const toolsFilePath=path.join(__dirname,'../src/db/tools.json');const sitemapFilePath=path.join(__dirname,'../src/app/sitemap.xml');const toolsData=JSON.parse(fs.readFileSync(toolsFilePath,'utf-8'));const toolsLinks=toolsData.map(tool=>`https://wdt.adambashaahmednaji.com${tool.link}`);const sitemapXml=fs.readFileSync(sitemapFilePath,'utf-8');const parser=new xml2js.Parser();parser.parseString(sitemapXml,(err,result)=>{if(err)throw err;const existingLinks=result.urlset.url.map(url=>url.loc[0]);const newTools=toolsLinks.filter(toolLink=>!existingLinks.includes(toolLink));if(newTools.length>0){newTools.forEach(newTool=>{result.urlset.url.push({loc:[newTool],lastmod:[new Date().toISOString()],priority:["0.80"]});});const builder=new xml2js.Builder();const updatedSitemapXml=builder.buildObject(result);fs.writeFileSync(sitemapFilePath,updatedSitemapXml);console.log(`Added ${newTools.length} new tools to the sitemap.`);}else{console.log('All tools are already present in the sitemap.');}});
